[
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "yaml",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "yaml",
        "description": "yaml",
        "detail": "yaml",
        "documentation": {}
    },
    {
        "label": "psutil",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "psutil",
        "description": "psutil",
        "detail": "psutil",
        "documentation": {}
    },
    {
        "label": "sys",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "sys",
        "description": "sys",
        "detail": "sys",
        "documentation": {}
    },
    {
        "label": "time",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "time",
        "description": "time",
        "detail": "time",
        "documentation": {}
    },
    {
        "label": "load_config",
        "kind": 2,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "def load_config(filename):\n    try:\n        with open(filename, 'r') as file:\n            config = yaml.safe_load(file)\n    except:\n        print_color(f\"Error: {filename} not found. Exiting.\", \"red\")\n        exit()\n    return config\ndef prompt_service_include(service_name):\n    while True:",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "prompt_service_include",
        "kind": 2,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "def prompt_service_include(service_name):\n    while True:\n        try:\n            response = input(f\"Include {service_name}? (y/n): \").strip().lower()\n            if response in ['y', 'n']:\n                return response == 'y'\n            else:\n                print_color(\"Please enter 'y' for yes or 'n' for no.\", \"red\")\n        except KeyboardInterrupt:\n            print()",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "check_port_conflicts",
        "kind": 2,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "def check_port_conflicts(selected_services):\n    all_ports = {}\n    conflict_ports = []\n    for service_name, config in selected_services.items():\n        ports = config.get('ports', [])\n        for port in ports:\n            # Split the port mapping and take only the host port part\n            parts = port.split(':')\n            host_port = parts[1] if len(parts) == 3 else (parts[0] if parts[1].isdigit() else parts[1])\n            # Check for port conflict and associate it with the service name",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "print_color",
        "kind": 2,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "def print_color(text, color):\n    colors = {\n        \"red\": \"\\033[91m\",\n        \"green\": \"\\033[92m\",\n        \"blue\": \"\\033[94m\",  # Added blue\n        \"magenta\": \"\\033[95m\",  # Added magenta\n        \"end\": \"\\033[0m\",\n    }\n    print(f\"{colors[color]}{text}{colors['end']}\")\ndef enforce_dependencies(selected_services, services):",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "enforce_dependencies",
        "kind": 2,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "def enforce_dependencies(selected_services, services):\n    # If snare or any tanner services are selected, ensure all are enabled\n    tanner_services = {'snare', 'tanner', 'tanner_redis', 'tanner_phpox', 'tanner_api'}\n    if tanner_services.intersection(selected_services):\n        print_color(\"[OK] - For Snare / Tanner to work all required services have been added to your configuration.\", \"green\")\n        for service in tanner_services:\n            selected_services[service] = services[service]\n    # If kibana is enabled, also enable elasticsearch\n    if 'kibana' in selected_services:\n        selected_services['elasticsearch'] = services['elasticsearch']",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "remove_unused_networks",
        "kind": 2,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "def remove_unused_networks(selected_services, services, networks):\n    used_networks = set()\n    # Identify networks used by selected services\n    for service_name in selected_services:\n        service_config = services[service_name]\n        if 'networks' in service_config:\n            for network in service_config['networks']:\n                used_networks.add(network)\n    # Remove unused networks\n    for network in list(networks):",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "def main():\n    config = load_config(config_filename)\n    # Separate services and networks\n    services = config['services']\n    networks = config.get('networks', {})\n    selected_services = {'tpotinit': services['tpotinit'],\n                         'logstash': services['logstash']}  # Always include tpotinit and logstash\n    for service_name, service_config in services.items():\n        if service_name not in selected_services:  # Skip already included services\n            if prompt_service_include(service_name):",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "version",
        "kind": 5,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "version = \\\n\"\"\"\n ____  [T-Pot]         _            ____        _ _     _\n/ ___|  ___ _ ____   _(_) ___ ___  | __ ) _   _(_) | __| | ___ _ __\n\\___ \\ / _ \\ '__\\ \\ / / |/ __/ _ \\ |  _ \\| | | | | |/ _` |/ _ \\ '__|\n ___) |  __/ |   \\ V /| | (_|  __/ | |_) | |_| | | | (_| |  __/ |\n|____/ \\___|_|    \\_/ |_|\\___\\___| |____/ \\__,_|_|_|\\__,_|\\___|_| v0.21\n# This script is intended for users who want to build a customized docker-compose.yml for T-Pot.\n# T-Pot Service Builder will ask for all the docker services to be included in docker-compose.yml.\n# The configuration file will be checked for conflicting ports.",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "header",
        "kind": 5,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "header = \\\n\"\"\"# T-Pot: CUSTOM EDITION\n# Generated on: {current_date}\n\"\"\"\nconfig_filename = \"tpot_services.yml\"\nservice_filename = \"docker-compose-custom.yml\"\ndef load_config(filename):\n    try:\n        with open(filename, 'r') as file:\n            config = yaml.safe_load(file)",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "config_filename",
        "kind": 5,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "config_filename = \"tpot_services.yml\"\nservice_filename = \"docker-compose-custom.yml\"\ndef load_config(filename):\n    try:\n        with open(filename, 'r') as file:\n            config = yaml.safe_load(file)\n    except:\n        print_color(f\"Error: {filename} not found. Exiting.\", \"red\")\n        exit()\n    return config",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "service_filename",
        "kind": 5,
        "importPath": "compose.customizer",
        "description": "compose.customizer",
        "peekOfCode": "service_filename = \"docker-compose-custom.yml\"\ndef load_config(filename):\n    try:\n        with open(filename, 'r') as file:\n            config = yaml.safe_load(file)\n    except:\n        print_color(f\"Error: {filename} not found. Exiting.\", \"red\")\n        exit()\n    return config\ndef prompt_service_include(service_name):",
        "detail": "compose.customizer",
        "documentation": {}
    },
    {
        "label": "cpu_usages",
        "kind": 5,
        "importPath": "docker.dionaea.dist.cpu_check",
        "description": "docker.dionaea.dist.cpu_check",
        "peekOfCode": "cpu_usages = []\nfor _ in range(3):\n    cpu_usages.append(target_process.cpu_percent(interval=1))\n# Calculate the average CPU usage\naverage_cpu_usage = sum(cpu_usages) / len(cpu_usages)\nprint(f\"Average CPU Usage of PID {pid} over 3 seconds: {average_cpu_usage}%\")\n# Check average CPU usage against the threshold\nif average_cpu_usage >= cpu_threshold:\n    print(f\"Average CPU usage of PID {pid} is above or equal to the threshold of {cpu_threshold}%.\")\n    sys.exit(1)",
        "detail": "docker.dionaea.dist.cpu_check",
        "documentation": {}
    },
    {
        "label": "average_cpu_usage",
        "kind": 5,
        "importPath": "docker.dionaea.dist.cpu_check",
        "description": "docker.dionaea.dist.cpu_check",
        "peekOfCode": "average_cpu_usage = sum(cpu_usages) / len(cpu_usages)\nprint(f\"Average CPU Usage of PID {pid} over 3 seconds: {average_cpu_usage}%\")\n# Check average CPU usage against the threshold\nif average_cpu_usage >= cpu_threshold:\n    print(f\"Average CPU usage of PID {pid} is above or equal to the threshold of {cpu_threshold}%.\")\n    sys.exit(1)\nelse:\n    print(f\"Average CPU usage of PID {pid} is below the threshold of {cpu_threshold}%. Exiting with code 0.\")\n    sys.exit(0)",
        "detail": "docker.dionaea.dist.cpu_check",
        "documentation": {}
    }
]